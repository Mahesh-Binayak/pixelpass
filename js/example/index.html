<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>QR Example</title>
</head>
<body>
Paste your VC JSON here
<textarea rows="20" cols="30" id="json-text" oninput="generateQR()"></textarea>
<img id="qr-image" src="" download>
<a download="QR.PNG"  id='download' href="" title="ImageName">
    click me
</a>

</body>

<script>
    function generateQR() {
        let jsonText = document.getElementById("json-text").value
        try {
            let jsonString = JSON.stringify(JSON.parse(jsonText))
            let xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState === 4 && this.status === 200) {
                    console.log(xhttp.responseText)
                }
                document.getElementById("qr-image").src = xhttp.responseText;
                document.getElementById("download").href = xhttp.responseText;
            };
            xhttp.open("POST", 'qr', true);
            xhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
            xhttp.send(jsonString);
        } catch (e) {
            alert("Invalid JSON")
        }
    }
</script>

</html>